## Команда для разворачивания приложения:
```bash
cd gateway
helm install gateway .  -n gateway
```

## Запуск тестов
```bash
    newman run tests.json
```

# Описание взаимодействия сервисов

### Запросы /auth/* nginx-ingress проксирует на сервис auth
### Запросы /users/* nginx-ingress проксирует на сервис user, с проверкой auth-request в сервисе auth.

### 1. Пользователь регистрируется по адресу /auth/register по username и password. Для упрощения процесса, в ответе возвращается id созданного пользователя.
### 2. Создаем профиль пользователя по адресу POST /create-user, передав в заголовке X-User-Id id, полученный в 1 пункте.
### 3. Пользователь авторизуется по адресу /auth/login по username и password.
### 4. Сервис auth создает сессию для найденного в БД пользователя, проставляет session_id в куку и возвращает 200 OK.
### 5. Пользователь делает запрос на получение/изменение/удаление своего профиля по адресу GET/PUT/DELETE /users/{user_id}. 
### 6. Nginx-ingress делает auth-request-подзапрос в сервис auth.
### 7. Сервис auth проверяет наличие сессии в куках, находит пользователя по session_id и сверяет, что он равен user_id, переданному в изначальном запросе.
### 8. Если проверка прошла успешно, сервис auth возвращает 200 OK, иначе 403 Forbidden.